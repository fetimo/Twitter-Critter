<div id="content">
<?r unless @critter.nil? ?>
	<canvas id="your-critter" class="critter_container" width="800" height="360">Critter requires canvas, upgrade to a nice browser.</canvas>
</div>
	<?r if session[:access_token] and @username == session[:access_token].params[:screen_name] ?>
<section class="friends">	
		<?r if session[:friends].count > 4 ?>
	<div id="left_scroll"><img src="../images/back.png" alt="Backwards"></div>
		<?r end ?>
	<div id="carousel_inner">  
    	<ul> 
			<?r session[:friends].sort.each do |f| #from http://blog.xambr.com/2009/11/26/ramaze-partials-with-etanni/ ?>
		    	#{ render_partial :friend, { :friend=>f } }
			<?r end ?>
			<?r if @suggested_friend ?>
				<p>Why not make a critter for <a href="/critter/#{@suggested_friend['username']}">#{@suggested_friend['name']}</a>?</p>
			<?r end ?>
		</ul>
	</div>
		<?r if session[:friends].count > 4 ?>
	<div id='right_scroll'><img src="../images/next.png" alt="Forwards"></div>
		<?r end ?>
</section>
	<?r end ?>
<!-- load libraries -->
<!--#{js('easel/lib/easel')}-->
#{js('jquery')}
#{js('easel/src/easeljs/utils/UID')}
#{js('easel/src/easeljs/geom/Matrix2D')}
#{js('easel/src/easeljs/geom/Rectangle')}
#{js('easel/src/easeljs/events/MouseEvent')}
#{js('easel/src/easeljs/utils/SpriteSheetUtils')}
#{js('easel/src/easeljs/display/DisplayObject')}
#{js('easel/src/easeljs/display/Container')}
#{js('easel/src/easeljs/display/Stage')}
#{js('easel/src/easeljs/display/Bitmap')}
#{js('easel/src/easeljs/utils/Ticker')}
#{js('easel/src/easeljs/filters/Filter')}
#{js('easel/src/easeljs/filters/ColorFilter')}
#{js('jquery-ui')}
#{js('underscore')}
#{js('backbone')}
#{js('carousel')}
#{js('animation')}
#{js('your-critter')}
<script>
/*
	Setup Critter model, url defaults to the username requested
*/
var Critter = Backbone.Model.extend({
	initialize: function (username) {
		this.fetch({url:'../critters/'+username});
	}
});
var	your_critter = new Critter('#{@username}'),
	elem = document.getElementById('your-critter'),
	stage = new Stage(elem),
	friend_stage = new Stage(elem);
friend_stage.autoClear = false;
build(your_critter);
</script>
#{js('friends')}
<?r else ?>
<p>No Critter called #{@username} exists yet! You can <a href="/">give life to it though</a>.</p>
<?r end ?>